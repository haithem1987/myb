<div class="card border-primary p-3">
  <div class="container">
    <div class="col-md">
      <form [formGroup]="invoiceForm">
        <div class="mb-3">
          <label for="invoiceNum" class="form-label">Invoice Num</label>
          <input
            type="text"
            class="form-control"
            id="invoiceNum"
            name="invoiceNum"
            formControlName="invoiceNum"
            placeholder="Enter invoice num "
            [ngClass]="{
              'is-invalid':
              invoiceForm.get('invoiceNum')?.invalid &&
              invoiceForm.get('invoiceNum')?.touched
            }"
          />
          @if(invoiceForm.get('invoiceNum')?.invalid &&
          invoiceForm.get('invoiceNum')?.touched){
          <div class="invalid-feedback">Invoice Num is required.</div>
          }
        </div>
        <div class="mb-3">
          <label for="invoicedate" class="form-label">Invoice date</label>
          <input
            id="invoicedate"
            formControlName="invoicedate"
            class="form-control"
            ngbDatepicker
            #invoicedatePicker="ngbDatepicker"
            (click)="invoicedatePicker.toggle()"
            [ngClass]="{
              'is-invalid':
              invoiceForm.get('invoicedate')?.invalid &&
              invoiceForm.get('invoicedate')?.touched
            }"
          />
          @if(invoiceForm.get('invoicedate')?.invalid &&
          invoiceForm.get('invoicedate')?.touched){
          <div class="invalid-feedback">Invoice Date is required.</div>
          }
        </div>

        <div class="mb-3">
          <label for="dueDate" class="form-label">Due date</label>
          <input
            id="dueDate"
            formControlName="dueDate"
            class="form-control"
            ngbDatepicker
            #duedatePicker="ngbDatepicker"
            (click)="duedatePicker.toggle()"
            
            [ngClass]="{
              'is-invalid':
              invoiceForm.get('dueDate')?.invalid &&
              invoiceForm.get('dueDate')?.touched
            }"
          />
          @if(invoiceForm.get('dueDate')?.invalid &&
          invoiceForm.get('dueDate')?.touched){
          <div class="invalid-feedback">Due Date is required.</div>
          }
        </div>
        <div class="mb-2">
          <label class="form-label">Client</label>
        </div>
        <div class="d-flex align-items-center">
          <button
            type="button"
            class="btn btn-outline-secondary me-4"
            (click)="openClientsModal()"
          >
            Select Client
          </button>
          @if(client != null){
          <div
            class="card border-secondary p-3 me-4"
            (click)="openClientsModal()"
          >
            <label>
              <span>&nbsp;&nbsp;Client Name:</span>
              <span>&nbsp;{{ client.firstName }}</span>
              <span>&nbsp;&nbsp;{{ client.lastName }}&nbsp;&nbsp;&nbsp;</span>
            </label>
            <label>
              <span>&nbsp;&nbsp;Client Type:</span>
              <span>&nbsp;{{ client.clientType }}&nbsp;</span>
            </label>
            <label>
              <span>&nbsp;&nbsp;Client Address:</span>
              <span>&nbsp;{{ client.address }}&nbsp;</span>
            </label>
          </div>

          } @if(client == null){
          <p style="color: rgba(229, 4, 4, 0.896)">{{ clientInvalid }}</p>
          }
        </div>
        <br />
        <div class="mb-2">
          <label for="invoiceNum" class="form-label">Invoice Details</label>
        
        <div class="mb-3">
          <button
            type="button"
            class="btn btn-outline-primary me-2"
            (click)="openAddItemModal()"
          >
            <i class="bi bi-plus-lg"></i> Item
          </button>
        </div>
        @if(invoiceDetails.length == 0){
        <p style="color: rgba(229, 4, 4, 0.896)">{{ invoiceDetailsInvalid }}</p>
        }
        </div>
        @if(invoiceDetails.length>0){
        <div class="mb-3">
          <div class="card border-primary p-2">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">Quantity</th>
                  <th scope="col">Description</th>
                  <th scope="col">Unit</th>
                  <th scope="col">Unit Price</th>
                  <th scope="col">Total Price</th>
                  <th scope="col">Actions</th>
                </tr>
              </thead>
              <tbody>
                @for(data of invoiceDetails; track data){
                <tr>
                  <td>{{ data.quantity }}</td>
                  <td>{{ data.description }}</td>
                  <td>{{ data.unit }}</td>
                  <td>{{ data.unitPrice }}</td>
                  <td>{{ data.unitPrice! * data.quantity! }}</td>
                  <td>
                    <button
                      type="button"
                      class="btn btn-outline-secondary"
                      (click)="removeItem(data)"
                    >
                      <i class="bi bi-trash"></i>
                    </button>
                  </td>
                </tr>

                }
              </tbody>
            </table>
          </div>
        </div>
      }
        <div class="mb-3">
          <br />
          <div class="d-flex justify-content-end">
            <button
              type="button"
              class="btn btn-outline-secondary me-2"
              [routerLink]="['/invoice']"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="btn btn-outline-primary"
              (click)="save()"
            >
              Save
            </button>
          </div>
        </div>
      </form>
      <div></div>
    </div>
    <!-- <div class="row">
      <div class="col-md me-4">
        <br />
        @if(extractedText == ''){
        <div class="bg-light card text-center dotted-card">
          <div class="card-body">
            <img
              src="http://100dayscss.com/codepen/upload.svg"
              class="upload-icon"
            />

            <p class="card-title">Choose Invoice to Upload !</p>
            <p class="card-text"></p>
            <div class="custom-file">
              <input
                #fileInput
                type="file"
                class="custom-file-input"
                id="customFile"
                (change)="onSelectFile(fileInput.files, $event)"
                multiple
                accept=".jpg, .png, .jpeg, .pdf"
                style="display: none"
              />

              <button
                class="btn btn-primary text-white"
                (click)="fileInput.click()"
              >
                Upload Document
              </button>
            </div>
          </div>
        </div>
        } @if(extractedText != ''){
        <div class="card border-secondary p-3">
          <div class="modal-header" style="display: flex; justify-content: space-between; ">
            <h3 style="color: #845bba">Extracted info:</h3>
            <button type="button" class="btn-close" aria-label="Close" (click)="closeOcr()"></button>
          </div>
          <div
            ngbScrollSpy
            #spy="ngbScrollSpy"
            class="p-3 rounded-2 mb-3"
            style="height: 350px"
          >
            @for(text of extractedTexts; track text){
            <p>{{ text }}</p>
            }
          </div>
        </div>
        }
      </div>
      
    </div> -->
  </div>
</div>
