<div class="container my-4">
  <div class="d-flex justify-content-between mb-3">
    <h2 class="mb-0" style="color: var(--bs-darklight)">Invoice Manager</h2>
    <button
      type="button"
      class="btn btn-primary"
      [routerLink]="['/invoice/create']"
    >
      <i class="bi bi-plus-lg"></i> Add Invoice
    </button>
  </div>
  <input
    type="text"
    class="form-control mb-3"
    placeholder="Search invoices..."
    [(ngModel)]="searchTerm"
  />
  <br />
  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center">
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a
            class="nav-link cursor-pointer"
            [ngClass]="{ active: activeTab === 'ACTIVE' }"
            (click)="setActiveTab('ACTIVE')"
          >
            {{ 'ACTIVE' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            [ngClass]="{ active: activeTab === 'ARCHIVED' }"
            (click)="setActiveTab('ARCHIVED')"
          >
            {{ 'ARCHIVED' | translate }}
          </a>
        </li>
      </ul>
    </div>
    <div class="table-responsive">
      <table class="table table-hover shadow">
        <thead class="table-secondary">
          <tr>
            <th scope="col" style="cursor: pointer">Invoice-Num</th>
            <th scope="col" style="cursor: pointer">Invoice date</th>
            <th scope="col" style="cursor: pointer">Due date</th>
            <th scope="col" style="cursor: pointer">Client</th>
            <th scope="col" style="cursor: pointer">SubTotal</th>
            <th scope="col" style="cursor: pointer">Total</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for(invoice of invoices$ | async; track invoice){
            @if(showInvoice(invoice)){
          <tr>
            <td [routerLink]="['/invoice/details', invoice.id]">
              {{ invoice.invoiceNum }}
            </td>
            <td [routerLink]="['/invoice/details', invoice.id]">
              {{ invoice.invoiceDate | date : 'MM/dd/yyyy' }}
            </td>
            <td [routerLink]="['/invoice/details', invoice.id]">
              {{ invoice.dueDate | date : 'MM/dd/yyyy' }}
            </td>
            <td [routerLink]="['/invoice/details', invoice.id]">
              {{ getClientName(invoice.clientID!) }}
            </td>
            <td [routerLink]="['/invoice/details', invoice.id]">
              {{ invoice.subTotal }}
            </td>
            <td [routerLink]="['/invoice/details', invoice.id]">
              {{ invoice.totalAmount }}
            </td>
            @if(!invoice.isArchived){
            <td>
              <button type="button" class="btn btn-outline-secondary" (click)="archiveInvoice(invoice)">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          }
          @if(invoice.isArchived){
            <td>
              <button
              class="btn btn-outline-secondary btn-sm me-2"
              (click)="restoreInvoice(invoice)"
            >
              <i class="bi bi-arrow-repeat me-2"></i>Restore
            </button>
            </td>
          }
          </tr>
          }
        }
        </tbody>
      </table>
    </div>
  </div>
</div>
