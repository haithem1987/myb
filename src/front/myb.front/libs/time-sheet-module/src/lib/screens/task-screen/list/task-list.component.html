<div class="container my-4">
  <div class="d-flex justify-content-between mb-3">
    <h2 class="mb-0" style="color: var(--bs-darklight)">
      {{ 'TASK_MANAGER' | translate }}
    </h2>
    <button type="button" class="btn btn-outline-primary" (click)="openModal()">
      <i class="bi bi-plus-lg"></i> {{ 'CREATE_TASK' | translate }}
    </button>
  </div>
  <input
    type="text"
    class="form-control mb-3"
    [placeholder]="'SEARCH_TASKS' | translate"
    [(ngModel)]="searchTerm"
    (keyup)="filterTasks()"
  />
  <div class="card pt-1">
    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col" (click)="onSort('name')" style="cursor: pointer">
            {{ 'NAME' | translate }}
            <i
              class="bi"
              [ngClass]="{
                'bi-sort-alpha-down':
                  sortColumn === 'name' && sortDirection === 'asc',
                'bi-sort-alpha-up':
                  sortColumn === 'name' && sortDirection === 'desc',
                'bi-sort': sortColumn !== 'name'
              }"
            ></i>
          </th>
          <th scope="col" (click)="onSort('startTime')" style="cursor: pointer">
            {{ 'START' | translate }}
            <i
              class="bi"
              [ngClass]="{
                'bi-sort-numeric-down':
                  sortColumn === 'startTime' && sortDirection === 'asc',
                'bi-sort-numeric-up':
                  sortColumn === 'startTime' && sortDirection === 'desc',
                'bi-sort': sortColumn !== 'startTime'
              }"
            ></i>
          </th>
          <th scope="col" (click)="onSort('endTime')" style="cursor: pointer">
            {{ 'END' | translate }}
            <i
              class="bi"
              [ngClass]="{
                'bi-sort-numeric-down':
                  sortColumn === 'endTime' && sortDirection === 'asc',
                'bi-sort-numeric-up':
                  sortColumn === 'endTime' && sortDirection === 'desc',
                'bi-sort': sortColumn !== 'endTime'
              }"
            ></i>
          </th>
          <th
            scope="col"
            (click)="onSort('isCompleted')"
            style="cursor: pointer"
          >
            {{ 'STATUS' | translate }}
            <i
              class="bi"
              [ngClass]="{
                'bi-sort-alpha-down':
                  sortColumn === 'isCompleted' && sortDirection === 'asc',
                'bi-sort-alpha-up':
                  sortColumn === 'isCompleted' && sortDirection === 'desc',
                'bi-sort': sortColumn !== 'isCompleted'
              }"
            ></i>
          </th>
          <th scope="col" (click)="onSort('dueDate')" style="cursor: pointer">
            {{ 'DUE_DATE' | translate }}
            <i
              class="bi"
              [ngClass]="{
                'bi-sort-numeric-down':
                  sortColumn === 'dueDate' && sortDirection === 'asc',
                'bi-sort-numeric-up':
                  sortColumn === 'dueDate' && sortDirection === 'desc',
                'bi-sort': sortColumn !== 'dueDate'
              }"
            ></i>
          </th>
          <th scope="col">{{ 'ACTIONS' | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let task of updatedTasks">
          <td>
            <div>{{ task.name }}</div>
            <div>{{ task.description }}</div>
          </td>
          <td>{{ task.startTime | date : 'MM/dd/yyyy, h:mm a' }}</td>
          <td>{{ task.endTime | date : 'MM/dd/yyyy, h:mm a' }}</td>
          <td>
            <span class="badge" [ngClass]="getCompletionBadgeClass(task)">
              {{ isCompletedLabel(task) | translate }}
            </span>
          </td>
          <td>
            ({{ getTimeRemaining(task.dueDate) | translate }})
            {{ task.dueDate | date : 'MM/dd/yyyy, h:mm a' }}
          </td>
          <td>
            <button
              type="button"
              class="btn btn-outline-primary me-2"
              (click)="openModal(task)"
            >
              <i class="bi bi-pencil-square"></i>
            </button>
            <button
              type="button"
              class="btn btn-outline-secondary"
              (click)="onDelete(task.id)"
            >
              <i class="bi bi-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
